# 仕様確認質問票

## 1. 機能仕様について

### 1.1 BTCアドレス管理
- [ ] BTCアドレスは実際のブロックチェーン接続が必要ですか？それとも表示用のダミーアドレスで十分ですか？
→これはダミーアドレスでOKです。ブロックチェーン接続も不要です。
- [ ] BTCアドレスの形式に制約はありますか？（例：Segwit、Legacy等）
→形式に制約はありません。今回は画面のモックアップが重要なので、キーは何でも良いです。
### 1.2 残高計算ロジック
- [ ] 「現在の保有金額から計算して~n%から+6%くらい」の具体的な計算式を教えてください
これは管理画面側から相場価格を設定する機能を想定しています。振れ幅については今のところは考慮しなくて良いです。
（手動で計算して登録する運用で耐えられるため）
相場時刻と相場価格を設定して、相場時刻時点での各ユーザーの保有BTCから資産価格を計算する仕組みです。
- [ ] この変動率はランダムですか？それとも何らかの規則に基づきますか？
変動率は考慮しなくて良いです。
- [ ] 計算結果が負の値になった場合の処理はどうしますか？
負の値になったら負の値をセットしてください。

### 1.3 取引結果
- [ ] 実際の入出金処理を行いますか？それとも表示のみのモックですか？
これはモックで良いです。DB側でマスタとして入出金履歴を持っておいてください。
- [ ] 入出金の承認フローは必要ですか？
不要です。ここは一旦おいておいて、管理画面側から任意ユーザーに対して任意金額を入出金できるようにしておきましょう。
- [ ] 入出金履歴の保持期間はありますか？
保持履歴は無制限でお願いします。

### 1.4 免許証画像・プロフィール
- [ ] 免許証画像アップロード後の承認フローは必要ですか？
ここはアップロード後、管理画面側でチェック済み、みたいなフラグは持っておきたいです。
- [ ] プロフィール情報にはどのような項目が必要ですか？（氏名、住所、電話番号等）
プロフィールは名前、住所、電話番号、メールアドレスをお願いします。
- [ ] 画像のファイルサイズ制限はありますか？
特に制限は持たないようにします。

## 2. データ設計について

### 2.1 残高管理
- [ ] 残高テーブルと入出金テーブル、どちらの設計を採用しますか？
  - 残高テーブル：現在残高のみを管理（効率的）
  - 入出金テーブル：全取引履歴から残高を計算（監査証跡）
入出金テーブル設計としてください。

### 2.2 相場マスター
- [ ] 相場データの更新頻度はどの程度ですか？（リアルタイム、1時間毎、1日毎等）
今の所一日一回ですが、頻度は変更する可能性があります
- [ ] 過去の相場データはどの程度保持しますか？
これは無期限で保持してください
- [ ] 相場データの取得元は決まっていますか？
モックなので、とりあえず人力で相場データを入力する想定です

### 2.3 ユーザー管理
- [ ] ユーザーの「停止」と「削除」の違いを教えてください
停止は、ログインできなくさせる措置です。停止から復帰することを考慮しています・
削除は完全な削除です。証跡データ以外（Cognitoのアカウントなど）は削除します
- [ ] 停止されたユーザーのデータはどうしますか？
停止中でもデータは保持し続けます
- [ ] ユーザーデータの保持ポリシーはありますか？
ユーザーデータは保持し続けます。ユーザー削除時も論理削除に近い形をとります。

## 3. セキュリティ・認証について

### 3.1 管理者権限
- [ ] 管理者に階層はありますか？（例：スーパー管理者、一般管理者）
今の所ないですが、十分あり得ます。Cognitoのグループ機能を利用した権限制御を想定しています。
グループAに対してどのような権限を与えるかを定義するテーブルを用意するイメージです。
- [ ] 管理者が操作できる範囲を教えてください
管理ページにフルアクセスできる権限としましょう。
- [ ] 管理者の作成・削除は誰が行いますか？
最初のユーザーはTerraForm内で自動作成することとしましょう。
これをadminという名前固定にして、このユーザーから増やしていく感じでいきましょう。

### 3.2 パスワードポリシー
- [ ] パスワードの強度要件はありますか？（文字数、文字種類等）
8文字以上、小文字と数字を含めましょう
- [ ] パスワードの変更頻度に制限はありますか？
なしで良いです
- [ ] パスワードリセット機能は必要ですか？
パスワードリセットは不要です。管理画面側から仮パスワードを発行する運用としましょう。

### 3.3 セッション管理
- [ ] セッションのタイムアウト時間はどの程度ですか？
1日で良いです・
- [ ] 同一ユーザーの同時ログインは許可しますか？
許可します。ただし、同時ログインは追跡できるようにしましょう。
Cognitoから払い出されたJWTキーを管理するセッションテーブルを用意する実装がいいと思います。
ログイン毎にユニークキーを払い出せば、ログインセッション数を追跡できます。
- [ ] ログイン試行回数の制限はありますか？
制限なしで良いです。
## 4. 技術選択について

### 4.1 Lambda・DynamoDB
- [ ] Lambda冷却による初回応答遅延は許容できますか？
許容できます。
- [ ] DynamoDBの読み書き容量の予算はありますか？
これはPayPerRequestで良いです
- [ ] バックアップの自動化は必要ですか？
必要です

### 4.2 ファイルアップロード
- [ ] ファイルアップロードは直接S3への署名付きURLを使用しますか？
- [ ] それともLambda経由でのアップロードですか？
Lambda経由でいきましょう。
- [ ] アップロード後のウイルススキャン等は必要ですか？
不要で良いです。

## 5. 運用面について

### 5.1 監査・ログ
- [ ] 管理者操作の記録は必要ですか？
不要です。
- [ ] ログの保持期間はどの程度ですか？
とりあえず無制限でお願いします。
- [ ] 外部監査への対応は必要ですか？
モックなので不要です

### 5.2 災害対策
- [ ] データのバックアップ頻度はどの程度ですか？
AWS標準機能の範囲で対応すれば良いです。
- [ ] 別リージョンへのレプリケーションは必要ですか？
- [ ] RTO/RPOの要件はありますか？
不要です。

### 5.3 エラーハンドリング
- [ ] システム障害時のユーザーへの通知方法はありますか？
不要です。
- [ ] メンテナンス画面は必要ですか？
不要です
- [ ] 障害復旧手順の自動化は必要ですか？
不要です

## 6. その他

### 6.1 開発・テスト
- [ ] 開発環境・ステージング環境は必要ですか？
必要です。
- [ ] 自動テストの実装範囲はどの程度ですか？
リントチェック、型チェックは必須です。
単体テストはvitestを予定しています。
- [ ] デプロイメントの自動化は必要ですか？
デプロイはAmplifyを予定しています。
ここはamplify.ymlを作ってくれればOKです。

### 6.2 予算・スケジュール
- [ ] AWSの月額予算の目安はありますか？
- [ ] 開発完了の目標時期はありますか？
- [ ] 段階的リリースは検討していますか？
これらは一旦考慮しなくて良いです。
---

## 追加質問事項

### A. 相場価格設定について
- [ ] 管理画面から相場価格を設定する際、過去日付での設定は可能にしますか？
可能とします
- [ ] 相場価格設定時に、全ユーザーの資産価格を即座に再計算しますか？それとも別途バッチ処理で行いますか？
即座に再計算お願いします。ただし将来的にはバッチ化します

### B. 入出金管理について  
- [ ] 管理画面からの入出金操作時、理由やメモを記録する機能は必要ですか？
必要です
- [ ] 入出金の種別（入金/出金/調整等）の分類は必要ですか？
入金、出勤は必要です。そのほかは現状不要です

### C. プロフィール承認について
- [ ] 免許証画像のチェック済みフラグは管理者のみが変更可能ですか？
管理者のみが変更可能としましょう。ここはそこまで厳格でなくてよいです
- [ ] チェック済み/未チェックでユーザーの機能制限はありますか？
機能制限はないです

### D. セッション管理について
- [ ] セッションテーブルでログイン履歴を管理する場合、ログアウト時の処理はどうしますか？
ログアウト時はセッションレコードを削除する方向でお願いします。ログイン履歴まではとらなくて良いです。
- [ ] 強制ログアウト機能（管理画面から特定ユーザーのセッションを無効化）は必要ですか？
不要です

### E. ユーザー削除について
- [ ] ユーザー削除時、関連する入出金履歴も論理削除しますか？それとも保持しますか？
保持します。削除後も記録は終えるようにしますが、関連履歴はそのままとしてください。
- [ ] 削除されたユーザーの資産はどう処理しますか？
そのままにしておいてください。
ユーザーは削除しても管理画面から引き続き見れるようにします（ログインは物理的にできなくする、という感じです）

---

**記入者:** rem15  
**記入日:** 2025-07-28  
**確認者:** _______________